<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of trackOptiPD</title>
  <meta name="keywords" content="trackOptiPD">
  <meta name="description" content="trackOptiPD Sets up directory structure for cell segmentation">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">SuperSeggerRelease</a> &gt; <a href="index.html">batch</a> &gt; trackOptiPD.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for SuperSeggerRelease/batch&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>trackOptiPD
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>trackOptiPD Sets up directory structure for cell segmentation</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function trackOptiPD(dirname, CONST) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> trackOptiPD Sets up directory structure for cell segmentation
 analysis for the SuperSeggerOpti package and moves
 aligned images to their respective folders.

 Copyright (C) 2016 Wiggins Lab
 University of Washington, 2016
 This file is part of SuperSeggerOpti.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="ReadFileName.html" class="code" title="function nameInfo = ReadFileName( str )">ReadFileName</a>	ReadFileName extracts the numbers after t,x,y,z in a string *t*c*xy*z*</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="BatchSuperSeggerOpti.html" class="code" title="function BatchSuperSeggerOpti(dirname_,skip,clean_flag,res,SEGMENT_FLAG)">BatchSuperSeggerOpti</a>	BatchSuperSeggerOpti runs everything from start to finish,</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function trackOptiPD(dirname, CONST)</a>
0002 <span class="comment">% trackOptiPD Sets up directory structure for cell segmentation</span>
0003 <span class="comment">% analysis for the SuperSeggerOpti package and moves</span>
0004 <span class="comment">% aligned images to their respective folders.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% Copyright (C) 2016 Wiggins Lab</span>
0007 <span class="comment">% University of Washington, 2016</span>
0008 <span class="comment">% This file is part of SuperSeggerOpti.</span>
0009 
0010 file_filter = <span class="string">'*.tif'</span>;
0011 
0012 
0013 
0014 dirseperator = filesep;
0015 
0016 
0017 <span class="keyword">if</span>(nargin&lt;1 || isempty(dirname))
0018     
0019     dirname=uigetdir()
0020     dirname=[dirname,dirseperator];
0021 <span class="keyword">else</span>
0022     <span class="keyword">if</span> dirname(length(dirname))~=dirseperator
0023         dirname=[dirname,dirseperator];
0024     <span class="keyword">end</span>
0025 <span class="keyword">end</span>
0026 
0027 
0028 
0029 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0030 <span class="comment">%</span>
0031 <span class="comment">% Make and move subdirs</span>
0032 <span class="comment">%</span>
0033 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0034 contents=dir([dirname file_filter]);
0035 
0036 
0037 <span class="keyword">if</span> ~isempty(contents);
0038     
0039     num_im = numel(contents);
0040     
0041     
0042     nt  = [];
0043     nc  = [];
0044     nxy = [];
0045     nz  = [];
0046     
0047     
0048     <span class="keyword">for</span> i = 1:num_im;
0049         nameInfo = <a href="ReadFileName.html" class="code" title="function nameInfo = ReadFileName( str )">ReadFileName</a>( contents(i).name );
0050         
0051         nt  = [nt,  nameInfo.npos(1,1)];
0052         nc  = [nc,  nameInfo.npos(2,1)];
0053         nxy = [nxy, nameInfo.npos(3,1)];
0054         nz  = [nz,  nameInfo.npos(4,1)];
0055     <span class="keyword">end</span>
0056     
0057     nt  = sort(unique(nt));
0058     nc  = sort(unique(nc));
0059     nxy = sort(unique(nxy));
0060     nz  = sort(unique(nz));
0061     
0062     <span class="comment">%xyPadSize = floor(log(max(nxy))/log(10))+1;</span>
0063     <span class="comment">%padString = ['%0',num2str(xyPadSize),'d'];</span>
0064     
0065     num_xy = numel(nxy);
0066     num_c  = numel(nc);
0067     num_z  = numel(nz);
0068     num_t  = numel(nt);
0069     
0070     dirname_list = cell(1,num_xy);
0071     
0072     <span class="keyword">if</span> nxy(1)==-1
0073         nxy = 1;
0074     <span class="keyword">end</span>
0075     
0076     <span class="keyword">if</span> nxy == 0
0077         xyPadSize = 1;
0078     <span class="keyword">else</span>
0079         xyPadSize = floor(log(max(nxy))/log(10))+1;
0080     <span class="keyword">end</span>
0081     
0082     padString = [<span class="string">'%0'</span>,num2str(xyPadSize),<span class="string">'d'</span>];
0083     
0084     <span class="keyword">for</span> i = 1:num_xy
0085         
0086         dirname_list{i} = [dirname,<span class="string">'xy'</span>,num2str(nxy(i), padString),dirseperator];
0087         mkdir( dirname_list{i} );
0088         mkdir( [dirname_list{i},<span class="string">'phase'</span>, dirseperator] );
0089         mkdir( [dirname_list{i},<span class="string">'seg'</span>,   dirseperator] );
0090         mkdir( [dirname_list{i},<span class="string">'cell'</span>,  dirseperator] );
0091         <span class="keyword">for</span> j = 2:num_c
0092             mkdir( [dirname_list{i},<span class="string">'fluor'</span>,num2str(j-1),dirseperator] );
0093         <span class="keyword">end</span>
0094     <span class="keyword">end</span>
0095     
0096     <span class="keyword">if</span> CONST.show_status
0097         h = waitbar(0, <span class="string">'Moving Files'</span>);
0098     <span class="keyword">else</span>
0099         h = [];
0100     <span class="keyword">end</span>
0101     <span class="keyword">for</span> i = 1:num_im;
0102         <span class="keyword">if</span> CONST.show_status
0103             waitbar(i/num_im,h);
0104         <span class="keyword">end</span>
0105         nameInfo = <a href="ReadFileName.html" class="code" title="function nameInfo = ReadFileName( str )">ReadFileName</a>( contents(i).name );
0106         
0107         it  = nameInfo.npos(1,1);
0108         ic  = nameInfo.npos(2,1);
0109         ixy = nameInfo.npos(3,1);
0110         iz  = nameInfo.npos(4,1);
0111         
0112         
0113         <span class="keyword">if</span> ixy==-1
0114             ii = 1;
0115         <span class="keyword">else</span>
0116             ii = find(ixy==nxy);
0117         <span class="keyword">end</span>
0118         
0119         <span class="keyword">if</span> ic ==-1
0120             ic  = 1;
0121         <span class="keyword">end</span>
0122         
0123         
0124         <span class="keyword">if</span> ic == 1
0125             tmp_target =  [dirname_list{ii},<span class="string">'phase'</span>, dirseperator];
0126         <span class="keyword">else</span>
0127             tmp_target =  [dirname_list{ii},<span class="string">'fluor'</span>,num2str(ic-1),dirseperator];
0128         <span class="keyword">end</span>
0129         
0130         tmp_source =   [dirname,contents(i).name];
0131         
0132         <span class="keyword">if</span> ispc
0133             move_cmd = <span class="string">'!move '</span>;
0134             tmp_target = [ tmp_target ];
0135             tmp_source = [ tmp_source ];
0136             
0137             <span class="keyword">try</span>
0138                 movefile( tmp_source, tmp_target ,<span class="string">'f'</span>);
0139             <span class="keyword">catch</span>
0140                 
0141                 keyboard
0142                 
0143             <span class="keyword">end</span>
0144         <span class="keyword">else</span>
0145             move_cmd = <span class="string">'!mv '</span>;
0146             move_cmd = [move_cmd,tmp_source,<span class="string">' '</span>,tmp_target];
0147             eval(move_cmd);
0148         <span class="keyword">end</span>
0149         
0150         
0151         
0152     <span class="keyword">end</span>
0153     <span class="keyword">if</span> CONST.show_status
0154         close(h);
0155     <span class="keyword">end</span>
0156     
0157 <span class="keyword">end</span>
0158 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 23-Feb-2016 16:32:17 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>