<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of towerMergeImages</title>
  <meta name="keywords" content="towerMergeImages">
  <meta name="description" content="towerMergeImages">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">SuperSeggerOpti_Release</a> &gt; <a href="index.html">viz</a> &gt; towerMergeImages.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for SuperSeggerOpti_Release/viz&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>towerMergeImages
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>towerMergeImages</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [imColor, imBW, towerIm, maskCons, nx, ny, max_x, max_y ] =towerMergeImages( imCell, maskCell, ssCell, xdim, skip, mag, CONST ) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> towerMergeImages
 INPUT :
   imCell
   maskCell
   ssCell
   xdim : x dimensions for the towers
   skip : skip frame
   mag :
   CONST : Constants file that was used.
 OUTPUT :
 mColor
 imBW
 towerIm
 maskCons
 nx
 ny
 max_x
 max_y
 Copyright (C) 2016 Wiggins Lab
 Unviersity of Washington, 2016
 This file is part of SuperSeggerOpti.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="doColorMap.html" class="code" title="function im_ = doColorMap( im, colormap_ )">doColorMap</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="makeConsIm.html" class="code" title="function [ imMosaic, imColor, imBW, imInv, kymo, kymoMask, I,kymoMax, kymoMaskMax, imMosaic10, imBWunmasked, imBWmask, hotPix,AA, BB ] = makeConsIm( dirName, CONST, skip, mag, disp_flag )">makeConsIm</a>	makeConsIm Computes consensus fluorescence localization from cells in a cell files</li><li><a href="makeTowerCons.html" class="code" title="function  imData = makeTowerCons( data, CONST, xdim,disp_flag, skip, mag )">makeTowerCons</a>	makeTowerCons Makes Times-Lapse Tower with normalized time and cell shape</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [imColor, imBW, towerIm, maskCons, nx, ny, max_x, max_y ] = </a><span class="keyword">...</span>
0002     towerMergeImages( imCell, maskCell, ssCell, xdim, skip, mag, CONST )
0003 <span class="comment">% towerMergeImages</span>
0004 <span class="comment">% INPUT :</span>
0005 <span class="comment">%   imCell</span>
0006 <span class="comment">%   maskCell</span>
0007 <span class="comment">%   ssCell</span>
0008 <span class="comment">%   xdim : x dimensions for the towers</span>
0009 <span class="comment">%   skip : skip frame</span>
0010 <span class="comment">%   mag :</span>
0011 <span class="comment">%   CONST : Constants file that was used.</span>
0012 <span class="comment">% OUTPUT :</span>
0013 <span class="comment">% mColor</span>
0014 <span class="comment">% imBW</span>
0015 <span class="comment">% towerIm</span>
0016 <span class="comment">% maskCons</span>
0017 <span class="comment">% nx</span>
0018 <span class="comment">% ny</span>
0019 <span class="comment">% max_x</span>
0020 <span class="comment">% max_y</span>
0021 <span class="comment">% Copyright (C) 2016 Wiggins Lab</span>
0022 <span class="comment">% Unviersity of Washington, 2016</span>
0023 <span class="comment">% This file is part of SuperSeggerOpti.</span>
0024 
0025 
0026 
0027 
0028 skip = 1;
0029 
0030 
0031 colormap_ = jet(256);
0032 
0033 max_x = 0;
0034 max_y = 0;
0035 
0036 
0037 <span class="comment">% get number of time slices.</span>
0038 T0 = numel( ssCell );
0039 
0040 <span class="keyword">for</span> ii = 1:T0
0041     max_x = max( [max_x, ssCell{ii}(2)] );
0042     max_y = max( [max_y, ssCell{ii}(1)] );
0043 <span class="keyword">end</span>
0044 
0045 
0046 <span class="keyword">if</span> exist( <span class="string">'xdim'</span>, <span class="string">'var'</span>) &amp;&amp; ~isempty( xdim )
0047     nx = xdim;
0048     ny = ceil( T0/nx/skip );
0049 <span class="keyword">else</span>
0050     nx = ceil( sqrt( T0*max_y/max_x/skip ) );
0051     ny = ceil( T0/nx/skip );
0052 <span class="keyword">end</span>
0053 
0054 max_x = max_x+mag;
0055 max_y = max_y+mag;
0056 
0057 imdim = [ max_y*ny + mag, max_x*nx + mag ];
0058 
0059 imColor   = uint8(zeros(imdim(1), imdim(2), 3 ));
0060 imBW      = zeros(imdim(1), imdim(2));
0061 maskCons  = zeros(imdim(1), imdim(2));
0062 towerIm   = zeros(imdim(1), imdim(2));
0063 
0064 im_list = [];
0065 
0066 
0067 <span class="comment">% make the composite image</span>
0068 <span class="keyword">for</span> ii = 1:T0
0069     
0070     yy = floor((ii-1)/nx/skip);
0071     xx = (ii-1)/skip-yy*nx;
0072     
0073     ss = ssCell{ii};
0074     
0075     dx = floor((max_x-ss(2))/2);
0076     dy = floor((max_y-ss(1))/2);
0077     
0078     mask = maskCell{ii};
0079     
0080     <span class="keyword">try</span>
0081         maskCons(1+yy*max_y+(1:ss(1))+dy, 1+xx*max_x+(1:ss(2))+dx) = mask;
0082         towerIm(    1+yy*max_y+(1:ss(1))+dy, 1+xx*max_x+(1:ss(2))+dx) = imCell{ii};
0083     <span class="keyword">catch</span>
0084         disp( <span class="string">'Error in makeTowerCons'</span> );
0085     <span class="keyword">end</span>
0086 <span class="keyword">end</span>
0087 
0088 <span class="comment">% rescale the dynamic range of the image.</span>
0089 f1mm = [min( towerIm( maskCons(:)&gt;.5 )), max( towerIm( maskCons(:)&gt;.5 ))];
0090 imBW = ag(towerIm.*maskCons,0,f1mm(2));
0091 
0092 
0093 <span class="keyword">if</span> CONST.view.falseColorFlag
0094     <span class="comment">% make the false color image</span>
0095     imColor = ag(<a href="doColorMap.html" class="code" title="function im_ = doColorMap( im, colormap_ )">doColorMap</a>( imBW, colormap_ ));
0096     mask3   = cat( 3, maskCons, maskCons, maskCons );
0097     imColor = uint8(uint8( double(imColor).*mask3));
0098 <span class="keyword">else</span>
0099     <span class="comment">% make normal image</span>
0100     del = 0.15;
0101     
0102     disk1 = strel(<span class="string">'disk'</span>,1);
0103     
0104     imColor = cat( 3, <span class="keyword">...</span>
0105         0*maskCons, <span class="keyword">...</span>
0106         uint8(double(imBW).*maskCons), <span class="keyword">...</span>
0107         del*ag(maskCons) );
0108 <span class="keyword">end</span>
0109 
0110 <span class="keyword">end</span>
0111 
0112</pre></div>
<hr><address>Generated on Tue 23-Feb-2016 13:44:44 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>