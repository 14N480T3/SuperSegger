<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of update_cell</title>
  <meta name="keywords" content="update_cell">
  <meta name="description" content="update_cell : updates the data structures">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">SuperSeggerOpti_Release</a> &gt; <a href="index.html">frameLink</a> &gt; update_cell.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for SuperSeggerOpti_Release/frameLink&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>update_cell
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>update_cell : updates the data structures</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function  [data_c, data_r, cell_count] = update_cell(data_c, ii, data_r, jj, time, errorStat, ii_sister, cell_count); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> update_cell : updates the data structures

 INPUT :
       data_c   : region (cell) data structure
       ii      :
       data_r  : linked reverse region (cell) data structure
       jj      :      
       time :
       errorStat :
       ii_sister :
       cell_count :</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="trackOptiErRes.html" class="code" title="function [list_touch] = trackOptiErRes(dirname,disp_flag,nc_flag,CONST,header)">trackOptiErRes</a>	trackOptiErRes : defines and resolves the errors produced during</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function  [data_c, data_r, cell_count] = update_cell( </a><span class="keyword">...</span>
0002     data_c, ii, data_r, jj, time, errorStat, ii_sister, cell_count);
0003 <span class="comment">% update_cell : updates the data structures</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% INPUT :</span>
0006 <span class="comment">%       data_c   : region (cell) data structure</span>
0007 <span class="comment">%       ii      :</span>
0008 <span class="comment">%       data_r  : linked reverse region (cell) data structure</span>
0009 <span class="comment">%       jj      :</span>
0010 <span class="comment">%       time :</span>
0011 <span class="comment">%       errorStat :</span>
0012 <span class="comment">%       ii_sister :</span>
0013 <span class="comment">%       cell_count :</span>
0014 <span class="comment">%</span>
0015 
0016 <span class="comment">% if jj is empty this is a new cell</span>
0017 <span class="keyword">if</span> isempty(jj)
0018     cell_count = cell_count+1;
0019     
0020     <span class="comment">% set the death/deathF to current time. If we come back,</span>
0021     <span class="comment">% we will reset them!</span>
0022     data_c.regs.death(ii)      = time; <span class="comment">% Death/divide time</span>
0023     data_c.regs.deathF(ii)     = 1;    <span class="comment">% Divides in this frame</span>
0024     
0025     data_c.regs.birth(ii)      = time; <span class="comment">% Birth Time: either</span>
0026     <span class="comment">% Division or appearance</span>
0027     data_c.regs.birthF(ii)     = 1;    <span class="comment">% Divide in this frame</span>
0028     
0029     data_c.regs.age(ii)        = 1;    <span class="comment">% cell age. starts at 1.</span>
0030     data_c.regs.divide(ii)     = 0;    <span class="comment">% succesful divide in this</span>
0031     <span class="comment">% this frame.</span>
0032     
0033     data_c.regs.ehist(ii)      = 0;    <span class="comment">% True if cell has an unresolved</span>
0034     <span class="comment">% error before this time.</span>
0035     data_c.regs.stat0(ii)      = 0;    <span class="comment">% Results from a successful</span>
0036     <span class="comment">% division.</span>
0037     
0038     <span class="keyword">if</span> isfield( data_c.regs, <span class="string">'lyse'</span> )
0039         data_c.regs.lyse.errorColor1Cum(ii) = time*double(logical(data_c.regs.lyse.errorColor1(ii)));    
0040         data_c.regs.lyse.errorColor2Cum(ii) = time*double(logical(data_c.regs.lyse.errorColor2(ii)));
0041 
0042         data_c.regs.lyse.errorColor1bCum(ii) = time*double(logical(data_c.regs.lyse.errorColor1b(ii)));    
0043         data_c.regs.lyse.errorColor2bCum(ii) = time*double(logical(data_c.regs.lyse.errorColor2b(ii)));
0044 
0045         data_c.regs.lyse.errorShapeCum(ii)  = time*double(logical(data_c.regs.lyse.errorShape(ii))); 
0046     <span class="keyword">end</span>
0047     
0048     data_c.regs.sisterID(ii)   = 0;   <span class="comment">% sister cell ID</span>
0049     data_c.regs.motherID(ii)   = 0;   <span class="comment">% mother cell ID</span>
0050     data_c.regs.daughterID{ii} = [];   <span class="comment">% daughter cell ID</span>
0051     data_c.regs.ID(ii)         = cell_count; <span class="comment">% cell ID number</span>
0052     data_c.regs.ID_{ii}        = cell_count; <span class="comment">% cell ID number.</span>
0053     <span class="comment">% this can hold a vector</span>
0054     <span class="comment">% can be resolved later</span>
0055     
0056 <span class="keyword">elseif</span> ii_sister;
0057     ii_sister = ii_sister(1);
0058     
0059     <span class="keyword">if</span> ~data_c.regs.sisterID(ii)
0060         
0061         cell_count = cell_count+1;
0062         
0063         <span class="comment">% set the death/deathF to current time. If we come back,</span>
0064         <span class="comment">% we will reset them!</span>
0065         data_c.regs.death(ii)      = time; <span class="comment">% Death/divide time</span>
0066         data_c.regs.deathF(ii)     = 1;    <span class="comment">% Divides in this frame</span>
0067         
0068         data_c.regs.birth(ii)      = time; <span class="comment">% Birth Time: either</span>
0069         <span class="comment">% Division or appearance</span>
0070         data_c.regs.birthF(ii)     = 1;    <span class="comment">% Divide in this frame</span>
0071         
0072         data_c.regs.age(ii)        = 1;    <span class="comment">% cell age. starts at 1.</span>
0073         data_c.regs.divide(ii)     = 0;    <span class="comment">% succesful divide in this</span>
0074         <span class="comment">% this frame.</span>
0075         
0076         data_c.regs.ehist(ii)      = errorStat;    <span class="comment">% True if cell has an unresolved</span>
0077         <span class="comment">% error before this time.</span>
0078         
0079         data_c.regs.stat0(ii)      = ~errorStat;    <span class="comment">% Results from a successful</span>
0080         <span class="comment">% division.</span>
0081         
0082         
0083         <span class="keyword">if</span> isfield( data_c.regs, <span class="string">'lyse'</span> )
0084             data_c.regs.lyse.errorColor1Cum(ii_sister) = <span class="keyword">...</span>
0085                 time*double(logical(data_c.regs.lyse.errorColor1(ii_sister)));    
0086             data_c.regs.lyse.errorColor2Cum(ii_sister) = <span class="keyword">...</span>
0087                 time*double(logical(data_c.regs.lyse.errorColor2(ii_sister)));
0088             data_c.regs.lyse.errorShapeCum(ii_sister)  = <span class="keyword">...</span>
0089                 time*double(logical(data_c.regs.lyse.errorShape(ii_sister))); 
0090             
0091             data_c.regs.lyse.errorColor1Cum(ii) = <span class="keyword">...</span><span class="comment"> </span>
0092                 time*double(logical(data_c.regs.lyse.errorColor1(ii)));    
0093             data_c.regs.lyse.errorColor2Cum(ii) = <span class="keyword">...</span><span class="comment"> </span>
0094                 time*double(logical(data_c.regs.lyse.errorColor2(ii)));
0095             data_c.regs.lyse.errorShapeCum(ii)  = <span class="keyword">...</span><span class="comment"> </span>
0096                 time*double(logical(data_c.regs.lyse.errorShape(ii))); 
0097 
0098             data_c.regs.lyse.errorColor1bCum(ii_sister) = <span class="keyword">...</span>
0099                 time*double(logical(data_c.regs.lyse.errorColor1b(ii_sister)));    
0100             data_c.regs.lyse.errorColor2bCum(ii_sister) = <span class="keyword">...</span>
0101                 time*double(logical(data_c.regs.lyse.errorColor2b(ii_sister)));
0102                         
0103             data_c.regs.lyse.errorColor1bCum(ii) = <span class="keyword">...</span><span class="comment"> </span>
0104                 time*double(logical(data_c.regs.lyse.errorColor1b(ii)));    
0105             data_c.regs.lyse.errorColor2bCum(ii) = <span class="keyword">...</span><span class="comment"> </span>
0106                 time*double(logical(data_c.regs.lyse.errorColor2b(ii)));
0107             
0108 
0109         <span class="keyword">end</span>
0110         
0111         data_c.regs.sisterID(ii)   = cell_count+1;   <span class="comment">% sister cell ID</span>
0112         data_c.regs.motherID(ii)   = data_r.regs.ID(jj);   <span class="comment">% mother cell ID</span>
0113         data_c.regs.daughterID{ii} = [];   <span class="comment">% daughter cell ID</span>
0114         data_c.regs.ID(ii)         = cell_count; <span class="comment">% cell ID number</span>
0115         data_c.regs.ID_{ii}        = cell_count; <span class="comment">% cell ID number.</span>
0116         <span class="comment">% this can hold a vector</span>
0117         <span class="comment">% can be resolved later</span>
0118 
0119         cell_count = cell_count+1;
0120         
0121         <span class="comment">% set the death/deathF to current time. If we come back,</span>
0122         <span class="comment">% we will reset them!</span>
0123         data_c.regs.death(ii_sister)      = time; <span class="comment">% Death/divide time</span>
0124         data_c.regs.deathF(ii_sister)     = 1;    <span class="comment">% Divides in this frame</span>
0125         
0126         data_c.regs.birth(ii_sister)      = time; <span class="comment">% Birth Time: either</span>
0127         <span class="comment">% Division or appearance</span>
0128         data_c.regs.birthF(ii_sister)     = 1;    <span class="comment">% Divide in this frame</span>
0129         
0130         data_c.regs.age(ii_sister)        = 1;    <span class="comment">% cell age. starts at 1.</span>
0131         data_c.regs.divide(ii_sister)     = 0;    <span class="comment">% succesful divide in this</span>
0132         <span class="comment">% this frame.</span>
0133         
0134         data_c.regs.ehist(ii_sister)      = errorStat;    <span class="comment">% True if cell has an unresolved</span>
0135         <span class="comment">% error before this time.</span>
0136         
0137         data_c.regs.stat0(ii_sister)      = ~errorStat;    <span class="comment">% Results from a successful</span>
0138         <span class="comment">% division.</span>
0139         
0140         data_c.regs.sisterID(ii_sister)   = cell_count-1;   <span class="comment">% sister cell ID</span>
0141         data_c.regs.motherID(ii_sister)   = data_r.regs.ID(jj);   <span class="comment">% mother cell ID</span>
0142         data_c.regs.daughterID{ii_sister} = [];   <span class="comment">% daughter cell ID</span>
0143         data_c.regs.ID(ii_sister)         = cell_count; <span class="comment">% cell ID number</span>
0144         data_c.regs.ID_{ii_sister}        = cell_count; <span class="comment">% cell ID number.</span>
0145         <span class="comment">% this can hold a vector</span>
0146         <span class="comment">% can be resolved later</span>
0147         
0148         <span class="comment">% set the death/deathF to current time. If we come back,</span>
0149         <span class="comment">% we will reset them!</span>
0150         data_r.regs.divide(jj)     = ~errorStat;    <span class="comment">% succesful divide in this</span>
0151         data_r.regs.daughterID{jj} = [cell_count-1,cell_count];   <span class="comment">% daughter cell ID</span>
0152         
0153     <span class="keyword">end</span>
0154 <span class="keyword">else</span>
0155     <span class="comment">% set the death/deathF to current time. If we come back,</span>
0156     <span class="comment">% we will reset them!</span>
0157     data_c.regs.death(ii)      = time; <span class="comment">% Death/divide time</span>
0158     data_c.regs.deathF(ii)     = 1;    <span class="comment">% Divides in this frame</span>
0159     
0160     data_c.regs.birth(ii)      = data_r.regs.birth(jj); <span class="comment">% Birth Time: either</span>
0161     <span class="comment">% Division or appearance</span>
0162     data_c.regs.birthF(ii)     = 0;    <span class="comment">% Divide in this frame</span>
0163     
0164     data_c.regs.age(ii)        = data_r.regs.age(jj)+1;    <span class="comment">% cell age. starts at 1.</span>
0165     data_c.regs.divide(ii)     = 0;    <span class="comment">% succesful divide in this</span>
0166     <span class="comment">% this frame.</span>
0167     
0168     
0169     data_c.regs.contactHist(ii) = data_r.regs.contactHist(jj) || data_c.regs.contact(ii);
0170     data_c.regs.ehist(ii)       = data_r.regs.ehist(jj) || errorStat;    <span class="comment">% True if cell has an unresolved</span>
0171     <span class="comment">% error before this time.</span>
0172     
0173    <span class="keyword">if</span> isfield( data_c.regs, <span class="string">'lyse'</span> )
0174         <span class="keyword">if</span> ~data_r.regs.lyse.errorColor1Cum(jj)
0175             data_c.regs.lyse.errorColor1Cum(ii) = <span class="keyword">...</span>
0176                 time*double(logical(data_c.regs.lyse.errorColor1(ii)));
0177         <span class="keyword">else</span>
0178             data_c.regs.lyse.errorColor1Cum(ii) = data_r.regs.lyse.errorColor1Cum(jj);
0179         <span class="keyword">end</span>
0180         
0181         <span class="keyword">if</span> ~data_r.regs.lyse.errorColor2Cum(jj)
0182             data_c.regs.lyse.errorColor2Cum(ii) = <span class="keyword">...</span>
0183                 time*double(logical(data_c.regs.lyse.errorColor2(ii)));
0184         <span class="keyword">else</span>
0185             data_c.regs.lyse.errorColor2Cum(ii) = data_r.regs.lyse.errorColor2Cum(jj);
0186         <span class="keyword">end</span>
0187         
0188         <span class="keyword">if</span> ~data_r.regs.lyse.errorColor1bCum(jj)
0189             data_c.regs.lyse.errorColor1bCum(ii) = <span class="keyword">...</span>
0190                 time*double(logical(data_c.regs.lyse.errorColor1b(ii)));
0191         <span class="keyword">else</span>
0192             data_c.regs.lyse.errorColor1bCum(ii) = data_r.regs.lyse.errorColor1bCum(jj);
0193         <span class="keyword">end</span>
0194         
0195         <span class="keyword">if</span> ~data_r.regs.lyse.errorColor2bCum(jj)
0196             data_c.regs.lyse.errorColor2bCum(ii) = <span class="keyword">...</span>
0197                 time*double(logical(data_c.regs.lyse.errorColor2b(ii)));
0198         <span class="keyword">else</span>
0199             data_c.regs.lyse.errorColor2bCum(ii) = data_r.regs.lyse.errorColor2bCum(jj);
0200         <span class="keyword">end</span>
0201 
0202         <span class="keyword">if</span> ~data_r.regs.lyse.errorShapeCum(jj)
0203             data_c.regs.lyse.errorShapeCum(ii)  = <span class="keyword">...</span>
0204                 time*double(logical(data_c.regs.lyse.errorShape(ii))); 
0205         <span class="keyword">else</span>
0206             data_c.regs.lyse.errorShapeCum(ii) = data_r.regs.lyse.errorShapeCum(jj);
0207         <span class="keyword">end</span>
0208         
0209     <span class="keyword">end</span>
0210        
0211     data_c.regs.stat0(ii)      = data_r.regs.stat0(jj);    <span class="comment">% Results from a successful</span>
0212     <span class="comment">% division.</span>
0213     data_c.regs.sisterID(ii)   = data_r.regs.sisterID(jj);   <span class="comment">% sister cell ID</span>
0214     data_c.regs.motherID(ii)   = data_r.regs.motherID(jj);   <span class="comment">% mother cell ID</span>
0215     data_c.regs.daughterID{ii} = [];   <span class="comment">% daughter cell ID</span>
0216     data_c.regs.ID(ii)         = data_r.regs.ID(jj); <span class="comment">% cell ID number</span>
0217     
0218     <span class="comment">% this can hold a vector can be resolved later</span>
0219     <span class="comment">% set the death/deathF to current time. If we come back,</span>
0220     <span class="comment">% we will reset them!</span>
0221     data_r.regs.death(jj)      = time; <span class="comment">% Death/divide time</span>
0222     data_r.regs.deathF(jj)     = 0;    <span class="comment">% Divides in this frame</span>
0223     data_r.regs.divide(jj)     = 0;    <span class="comment">% succesful divide in this</span>
0224 <span class="keyword">end</span>
0225 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 23-Feb-2016 13:44:44 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>